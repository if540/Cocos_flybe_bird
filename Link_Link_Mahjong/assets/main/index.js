System.register("chunks:///_virtual/global.ts",["cc"],(function(c){"use strict";var e;return{setters:[function(c){e=c.cclegacy}],execute:function(){var t,n;c({BonusScale:void 0,CardType:void 0}),e._RF.push({},"553cbUOpyZCDqf0hrGx3lC7","global",void 0),function(c){c[c.FA=1]="FA",c[c.JU=2]="JU",c[c.TI=3]="TI",c[c.TO=4]="TO",c[c.BA=5]="BA"}(t||(t=c("CardType",{}))),function(c){c[c.FA=25]="FA",c[c.JU=25]="JU",c[c.TI=1]="TI",c[c.TO=1]="TO",c[c.BA=1]="BA"}(n||(n=c("BonusScale",{}))),e._RF.pop()}}}));

System.register("chunks:///_virtual/play.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./game_mgr.ts"],(function(e){"use strict";var r,t,n,i,a,o,p,l,u,c,s,f;return{setters:[function(e){r=e.cclegacy,t=e._decorator,n=e.Node,i=e.SpriteFrame,a=e.Input,o=e.Component},function(e){p=e.applyDecoratedDescriptor,l=e.inheritsLoose,u=e.defineProperty,c=e.assertThisInitialized,s=e.initializerDefineProperty},function(e){f=e.GameMgr}],execute:function(){var y,h,m,d,g,b,_,v,I;r._RF.push({},"5f46fEZnoVAyqjnyTuQd0JK","play",void 0);var F=t.ccclass,S=t.property;e("play",(y=F("play"),h=S(n),m=S([i]),d=S(n),y((_=p((b=function(e){function r(){for(var r,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return r=e.call.apply(e,[this].concat(n))||this,u(c(r),"_gameIns",null),s(c(r),"panelGroup",_,c(r)),s(c(r),"cardTypeSpriteFrame",v,c(r)),s(c(r),"btnRefresh",I,c(r)),r}l(r,e);var t=r.prototype;return t.onLoad=function(){this._gameIns=f.GetInstance(),this._gameIns.initial(this.panelGroup.children,this.cardTypeSpriteFrame)},t.start=function(){var e=this;this.btnRefresh.on(a.EventType.MOUSE_DOWN,(function(){e._gameIns.refresh()}))},t.update=function(e){},r}(o)).prototype,"panelGroup",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=p(b.prototype,"cardTypeSpriteFrame",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=p(b.prototype,"btnRefresh",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=b))||g));r._RF.pop()}}}));

System.register("chunks:///_virtual/card.ts",["cc","./_rollupPluginModLoBabelHelpers.js","./game_mgr.ts"],(function(t){"use strict";var n,i,o,e,s,a,c,r,p,u,l,h,d,_;return{setters:[function(t){n=t.cclegacy,i=t._decorator,o=t.AudioSource,e=t.Animation,s=t.Input,a=t.Vec3,c=t.Sprite,r=t.tween,p=t.Component},function(t){u=t.inheritsLoose,l=t.defineProperty,h=t.assertThisInitialized,d=t.createClass},function(t){_=t.GameMgr}],execute:function(){var f;n._RF.push({},"826c1fJEQBJZrzPOZsFHEyc","card",void 0);var y=i.ccclass;i.property,t("card",y("card")(f=function(t){function n(){for(var n,i=arguments.length,o=new Array(i),e=0;e<i;e++)o[e]=arguments[e];return n=t.call.apply(t,[this].concat(o))||this,l(h(n),"_index",null),l(h(n),"_pos",null),l(h(n),"_cardType",null),l(h(n),"_audioPick",null),l(h(n),"_audioStop",null),l(h(n),"_spAnimation",null),n}u(n,t);var i=n.prototype;return i.onLoad=function(){var t=this.getComponents(o);this._audioPick=t[0],this._audioStop=t[1],this._spAnimation=this.getComponent(e)},i.initial=function(t,n){var i=this;this._index=t,this._pos=n,this.node.on(s.EventType.MOUSE_DOWN,(function(){_.GetInstance().pickOne(i)}))},i.reset=function(){this.node.setScale(a.ONE),this.node.getComponent(c).spriteFrame=null},i.picked=function(){this._audioPick.play(),this.playAnimation()},i.bingo=function(){var t=this;r(this.node).to(1,{scale:a.ZERO},{easing:"elasticInOut",onComplete:function(){t.stopAnimation()}}).start()},i.shake=function(){var t=new a,n=this.node.getPosition(),i=.03;this._audioStop.play(),r(this.node).to(i,{position:t.set(n.x+2,n.y,n.z)},{easing:"elasticOut"}).to(i,{position:t.set(n.x+-2,n.y,n.z)},{easing:"elasticOut"}).to(i,{position:n},{easing:"elasticOut"}).start()},i.playAnimation=function(){this._spAnimation.stop(),this._spAnimation.play("pick")},i.stopAnimation=function(){this._spAnimation.stop(),this._spAnimation.play("normal")},d(n,[{key:"pos",get:function(){return this._pos}},{key:"cardType",get:function(){return this._cardType},set:function(t){this._cardType=t}}]),n}(p))||f);n._RF.pop()}}}));

System.register("chunks:///_virtual/commButton.ts",["cc","./_rollupPluginModLoBabelHelpers.js"],(function(t){"use strict";var o,n,e,i,r,s,c,u,a,l;return{setters:[function(t){o=t.cclegacy,n=t._decorator,e=t.Input,i=t.AudioSource,r=t.tween,s=t.Vec3,c=t.Component},function(t){u=t.inheritsLoose,a=t.defineProperty,l=t.assertThisInitialized}],execute:function(){var p;o._RF.push({},"c7888zvhPRP7Yo73PQ3+4tJ","commButton",void 0);var h=n.ccclass;n.property,t("commButton",h("commButton")(p=function(t){function o(){for(var o,n=arguments.length,e=new Array(n),i=0;i<n;i++)e[i]=arguments[i];return o=t.call.apply(t,[this].concat(e))||this,a(l(o),"_audioPick",null),o}u(o,t);var n=o.prototype;return n.onLoad=function(){this.node.on(e.EventType.MOUSE_DOWN,this.onMouseDown,this);var t=this.getComponents(i);this._audioPick=t[0]},n.start=function(){},n.onMouseDown=function(){console.log("onMouseDown Inner trigger");var t=this.node.eulerAngles.clone();this._audioPick.play(),r(this.node).to(.3,{eulerAngles:new s(0,0,-360)},{easing:"cubicOut"}).to(0,{eulerAngles:t}).start()},o}(c))||p);o._RF.pop()}}}));

System.register("chunks:///_virtual/game_mgr.ts",["cc","./global.ts","./_rollupPluginModLoBabelHelpers.js","./card.ts"],(function(t){"use strict";var r,e,n,i,o,a,s,c,h,u;return{setters:[function(t){r=t.cclegacy,e=t._decorator,n=t.Vec2,i=t.Sprite,o=t.Component},function(t){a=t.CardType},function(t){s=t.inheritsLoose,c=t.defineProperty,h=t.assertThisInitialized},function(t){u=t.card}],execute:function(){r._RF.push({},"c7b6bZTr2tKDYKHojUJ6Kpn","game_mgr",void 0);e.ccclass,e.property;var l=new n,p=t("GameMgr",function(t){function r(){for(var r,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return r=t.call.apply(t,[this].concat(n))||this,c(h(r),"rowCount",4),c(h(r),"colCount",5),c(h(r),"pickCount",10),c(h(r),"_cards",[[],[],[],[],[]]),c(h(r),"_cardTypeSpriteFrame",[]),c(h(r),"_currentPick",[]),c(h(r),"_path",[]),c(h(r),"_gameData",[[],[],[],[],[]]),r}s(r,t),r.GetInstance=function(){return null==r.instance&&(r.instance=new r),r.instance};var e=r.prototype;return e.initial=function(t,r){for(var e=0;e<this.colCount;e++)for(var n=0;n<this.rowCount;n++)this._cards[e][n]=t[this.to1d(l.set(e,n))];this._cardTypeSpriteFrame=r,this.initialCards(),this.randomPlaceCards()},e.initialCards=function(){var t=this;this._cards.forEach((function(r,e){for(var n=0;n<r.length;n++)t._cards[e][n].getComponent(u).initial(t.to1d(l.set(e,n).clone()),l.set(e,n).clone()),t._cards[e][n].getComponent(i).spriteFrame=null,t._gameData[e][n]=0}))},e.clearPick=function(){this._currentPick.forEach((function(t){t.stopAnimation()})),this._currentPick=[]},e.randomPlaceCards=function(){for(var t=this,r=function(r){var e=[];t._gameData.forEach((function(r,n){for(var i=0;i<r.length;i++)0==t._gameData[n][i]&&e.push(l.set(n,i).clone())}));var n=Math.floor(Math.random()*e.length),o=e[n];e.splice(n,1);var s=Math.floor(Math.random()*e.length),c=e[s],h=t.randomPickCardType();t._gameData[o.x][o.y]=h,t._gameData[c.x][c.y]=h;var p=t._cards[o.x][o.y],f=t._cards[c.x][c.y];p.getComponent(u).cardType=h,f.getComponent(u).cardType=h,p.getComponent(i).spriteFrame=t._cardTypeSpriteFrame[a[h]],f.getComponent(i).spriteFrame=t._cardTypeSpriteFrame[a[h]]},e=0;e<this.pickCount;e++)r()},e.randomPickCardType=function(){var t=Object.keys(a).length/2,r=Math.floor(Math.random()*t)+1;return a[""+r]},e.refresh=function(){var t=this;this.clearPick(),this._path=[],this._cards.forEach((function(r,e){for(var n=0;n<r.length;n++){t._cards[e][n].getComponent(u).reset(),t._gameData[e][n]=0}})),this.randomPlaceCards()},e.pickOne=function(t){var r=null,e=this._currentPick.length;if(0==e)return this._currentPick.push(t),void t.picked();if(1==e){if(r=this._currentPick[0],t.pos==r.pos)return console.log("同位置",t.pos,r.pos),t.shake(),this._currentPick.pop(),void r.stopAnimation();if(t.cardType!==r.cardType)return console.log("牌色不同",t.cardType,r.cardType),t.shake(),void r.shake();this._currentPick.push(t),t.picked(),this.remove(r.pos,t.pos)?(console.log("連線"),r.bingo(),t.bingo(),this._gameData[r.pos.x][r.pos.y]=0,this._gameData[t.pos.x][t.pos.y]=0):(console.log("不連線"),r.shake(),t.shake()),this.clearPick()}},e.to1d=function(t){return t.x+t.y*this.colCount},e.to2d=function(t){var r=t%this.colCount,e=Math.floor(t/this.colCount);return l.set(r,e)},e.isBlocked=function(t,r){return(t.x!=r.x||t.y!=r.y)&&0!=this._gameData[t.x][t.y]},e.horizon=function(t,r){if(t.y!=r.y)return!1;if(t.x>r.x){for(var e=t.x-1;e>=r.x;e--)if(this.isBlocked(l.set(e,t.y),r))return!1}else for(var n=t.x+1;n<=r.x;n++)if(this.isBlocked(l.set(n,t.y),r))return!1;return!0},e.vertical=function(t,r){if(t.x!=r.x)return!1;if(t.y>r.y){for(var e=t.y-1;e>=r.y;e--)if(this.isBlocked(l.set(t.x,e),r))return!1}else for(var n=t.y+1;n<=r.y;n++)if(this.isBlocked(l.set(t.x,n),r))return!1;return!0},e.turn_once=function(t,r){console.log("turn_once");var e=new n(t.x,r.y),i=new n(r.x,t.y),o=!1;return this.isBlocked(e,t)||(o=this.vertical(t,e)&&this.horizon(e,r)),1==o||this.isBlocked(i,t)||(o=this.vertical(r,i)&&this.horizon(i,t)),o},e.turn_twice=function(t,r){this._path=[],this.upPath(t),this.downPath(t),this.leftPath(t),this.rightPath(t);for(var e=0;e<this._path.length;e++){var n=this._path[e],i=this.horizon(n,t);if(0==i&&this.vertical(n,t),1==i&&this.turn_once(n,r))return!0}return!1},e.upPath=function(t){for(var r=t.y-1;r>=0;r--){var e=l.set(t.x,r).clone();if(this.isBlocked(e,t))break;this._path.push(e)}},e.downPath=function(t){for(var r=t.y+1;r<=this.rowCount;r++){var e=l.set(t.x,r).clone();if(this.isBlocked(e,t))break;this._path.push(e)}},e.leftPath=function(t){for(var r=t.x-1;r>=0;r--){var e=l.set(r,t.y).clone();if(this.isBlocked(e,t))break;this._path.push(e)}},e.rightPath=function(t){for(var r=t.x+1;r<this.colCount;r++){var e=l.set(r,t.y).clone();if(this.isBlocked(e,t))break;this._path.push(e)}},e.remove=function(t,r){return 1==this.horizon(t,r)||(1==this.vertical(t,r)||(1==this.turn_once(t,r)||1==this.turn_twice(t,r)))},r}(o));c(p,"instance",null),r._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./global.ts","./card.ts","./game_mgr.ts","./play.ts","./commButton.ts"],(function(){"use strict";return{setters:[null,null,null,null,null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});